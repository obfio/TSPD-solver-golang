package main

import (
	"TSPD-solver-golang/TSPD"
	"fmt"
	"math/rand"
	"time"
)

func init() {
	rand.Seed(time.Now().UnixNano())
}

func main() {
	bobStr := "101111101010102000000052000000052000000062000000022d4417f47200000096200000000200000002300000029application%2fx%2dwww%2dform%2durlencoded300000135https%3a%2f%2fbe.caja%2dingenieros.es%2fBEWeb%2f3025%2f6025%2fCABEm_0_fusionRestyling.action%3bjsessionid%3dAkSAlX0unN5BBKpCJzukKa0ydMxuQynqcXPNTyyS.lima%3fIDIOMA%3d02%26OPGENERICA%3d%26PUESTO%3d%26OPERADOR%3d%26EASYCODE%3d%26DEDONDE%3dGENE%26PERR_AUX%3d%26OPERACION%3d%26RANDOM%3d20250506235312%26REFDESDE%3d300000006/TSPD/300000008TSPD_10130000000cTSPD_101_DID300000005https3000000f0087b6cfa27ab2000c7c207e42bfe856ea891ab5ce18e5b5d7de6c2c82d2682c61863c76b5c2df2d2087627877a0a48003c7e872cc1574fb124746178f61c27098838ee1947849e0c482d58e8f69dfce18d1abcc8d6e5887878aeffccd1ae2e2d63e518bb011af4040fcd3fb4e205b7878f4f01e51ccbd8b7300000002TS3000001d9PAN%3dASDASDASD%26PIN%3d021d721c9d80c70289c25530d245ceda%26OPERACION%3d0002%26IDIOMA%3d02%26CAJA%3d3025%26SELLO%3d2025.05.06.23.53.19%26IDEN%3d%26PINV2%3dsi%26NUMV%3d021d721c9d80c70289c25530d245ceda%26INILOGIN%3dS%26PUESTO%3d%26OPERADOR%3d%26EASYCODE%3d%26BROKER%3dSI%26OPGENERICA%3d%26GENERICA%3dS%26DEDONDE%3dGENE%26ACCSS%3dFUSION%26REFDESDE%3d%26REFDESDE%3d%26EASYCODE%3d%26OPGENERICA%3d%26PERR_AUX%3d%26RANDOM%3d20250506235312%26DEDONDE%3dGENE%26OPERADOR%3d%26PUESTO%3d200000000"
	bobOut, err := TSPD.DecodeBob(bobStr)
	if err != nil {
		fmt.Println(err)
		return
	}
	loaderStr := "0858a1935d018000eb31f80e30158c467560fe9d598bcac4cb1f15a3caecbd7c31e2467ea2253b0ac7a6fe59bafd7930ac200fee3be76559c25e3a6c08afe2b29d38c8a2af332e182c76b5e09d765d03359a15b16881e99747bb302a6c69292dc1f7e053e9539f346bf2d40deb0e026b5bdfbc612c1fd61d50b049778bd29ecb485ecb67327e176b"
	//fmt.Println(TEA.DecryptLoaderStr(loaderStr))
	cookie := TSPD.GenerateCookie(bobOut, loaderStr)
	fmt.Println(cookie)
}
